<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/allLadles.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">

    <title>Admin | Dashboard</title>

    <style>
        .table {
            height: 300px;
            overflow-y: scroll;
        }

        table {
            width: 100%;
            text-align: left;
            border-collapse: collapse;
        }

        tr {
            border-bottom: 1px solid #f1f1f1;
        }

        td,
        th {
            padding-block: 10px;
        }

        .mainn {
            width: 97%;
            /* height: 100vh; */
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: pop;
            flex-direction: column;
            border: 2px solid red;
            border-radius: 25px;
            padding-bottom: 43px;
            margin-top: 27px;
            margin-bottom: 27px;
            padding-top: 1rem;
        }

        #progressWala {
            display: flex;
            margin-top: 23px;
        }

        #progressWala li {
            list-style: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-right: 35px;
        }

        #progressWala .last {
            margin-right: 33px;
        }

        #progressWala li .icon {
            font-size: 35px;
            color: #ff4732;
            margin: 0 60px;
        }

        #progressWala li .text {
            font-size: 14px;
            font-weight: 600;
            color: #ff4732;
        }

        /* Progress Div Css  */

        ul li .progress {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: rgba(68, 68, 68, 0.781);
            margin: 14px 0;
            display: grid;
            place-items: center;
            color: #fff;
            position: relative;
            cursor: pointer;
        }

        .progress::after {
            content: " ";
            position: absolute;
            width: 125px;
            height: 5px;
            background-color: rgba(68, 68, 68, 0.781);
            right: 30px;
        }

        .one::after {
            width: 0;
            height: 0;
        }

        ul li .progress .uil {
            display: none;
        }

        ul li .progress p {
            font-size: 13px;
        }

        /* Active Css  */

        ul li .active {
            background-color: #ff4732;
            display: grid;
            place-items: center;
        }

        li .active::after {
            background-color: #ff4732;
        }

        ul li .active p {
            display: none;
        }

        ul li .active .uil {
            font-size: 20px;
            display: flex;
        }

          /* ====================== */
          #line-container {
            position: relative;
            width: 100%;
            /* Adjust the width as needed */
            height: 5px;
            margin-top: 2rem;
            /* Adjust the height as needed */
            background-color: #f0f0f0;
            /* Background color of the line */
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .point {
            /* position: absolute; */
            width: 5px;
            /* Diameter of the circle */
            height: 5px;
            /* background-color: transparent; */
            border-radius: 50%;
            transition: background-color 0.3s ease;
            display: flex;
            justify-content: center;
            color: white;
        }

        .point:nth-child(odd) {
            /* transform: scale(1.5); */
            width: 20px;
            /* Diameter of the circle */
            height: 20px;
            background-color: rgb(223, 222, 222)
        }

        #text-container{
            position: relative;
            width: 100%;
            height: 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>

<body>
    <section class="header">
        <div class="logo">
            <!-- <i class="ri-menu-line icon icon-0 menu"></i> -->
            <a href="/dashboard"> <h2>Ladle<span>Vision</span></h2></a>
        </div>
    </section>

    <section class="main">
        <div class="sidebar">
            <ul class="sidebar--items">
                <li>
                    <a href="/dashboard">
                        <span class="icon icon-1"><i class="ri-layout-grid-line"></i></span>
                        <span class="sidebar--item">Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="/ladles/allLadles" id="active--link">
                        <span class="icon icon-2"><i class="ri-user-line"></i></span>
                        <span class="sidebar--item">View Ladles</span>
                    </a>
                </li>
                <li>
                    <a href="/alert">
                        <span class="icon icon-4"><i class="ri-user-line"></i></span>
                        <span class="sidebar--item">Notifications</span>
                    </a>
                </li>
                <li>
                    <a href="/ladles/maintainance">
                        <span class="icon icon-5"><i class="ri-line-chart-line"></i></span>
                        <span class="sidebar--item">Maintenance</span>
                    </a>
                </li>
            </ul>
            <ul class="sidebar--bottom-items">
                <!-- <li>
                        <a href="#">
                            <span class="icon icon-7"><i class="ri-settings-3-line"></i></span>
                            <span class="sidebar--item">Settings</span>
                        </a>
                    </li> -->
                <li>
                    <a href="/auth/logout">
                        <span class="icon icon-8"><i class="ri-logout-box-r-line"></i></span>
                        <span class="sidebar--item">Logout</span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="main--content">
            <% if(success) { %>
            <div class="overview">
                <div class="title">
                    <h2 class="section--title">Ladle Details</h2>

                </div>
                <br>
                <div class="table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ladle</th>
                                <th>Ladle Info.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Ladle No. </td>
                                <td>
                                    <%=data.LadleNo%>
                                </td>
                            </tr>
                            <tr>
                                <td>Steel Grade</td>
                                <td>
                                    <%=data.SteelGrade%>
                                </td>
                            </tr>
                            <tr>
                                <td>Temprature</td>
                                <td style="color: red;">
                                    <%=data.Temperature%> K
                                </td>
                            </tr>
                            <tr>
                                <td>Last Inspection Date</td>
                                <td>
                                    <%=data.LastCheckDate%>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                <h1>Live Ladle Location</h1>
                <!-- Ladles Mapping -->
                <div id="line-container">
                    <div class="point" id="point1"></div>
                    <div class="point" id="point2"></div>
                    <div class="point" id="point3"></div>
                    <div class="point" id="point4"></div>
                    <div class="point" id="point5"></div>
                    <div class="point" id="point6"></div>
                    <div class="point" id="point7"></div>
                    <div class="point" id="point8"></div>
                    <div class="point" id="point9"></div>
                </div>

                <div id="text-container">
                    <div >Start</div>
                    <div ></div>
                    <div style="color: brown;" >SMS 1</div>
                    <div ></div>
                    <div style="color: brown;">SMS 2</div>
                    <div ></div>
                    <div style="color: brown;">SMS 3</div>
                    <div ></div>
                    <div style="color: red;" >End</div>
                </div>

            </div>
            <% } else { %>
                <p><%=message%></p>
            <% } %>

    </section>

    <script type="module">
        const randomColors = [
        "#3498db",
        "#e74c3c",
        "#2ecc71",
        "#f39c12",
        "#9b59b6",
        "#1abc9c",
        "#e67e22",
        "#3498db",
        "#16a085",
        "#c0392b",
        "#2980b9",
        "#f1c40f",
        "#8e44ad",
        "#27ae60",
        "#d35400",
        "#34495e",
        "#e74c3c",
        "#2c3e50",
        "#f39c12",
        "#7f8c8d"
        ];
        function resetColors() {
            const points = document.querySelectorAll('.point');
            points.forEach((point, i) => {
                if (i % 2 == 0) {
                    point.style.backgroundColor = 'rgb(223, 222, 222)';
                } else {
                    point.style.backgroundColor = '#f0f0f0';
                    point.style.width = "5px";
                    point.style.height = "5px";
                }
            });
        }

        function resetText() {
            const points = document.querySelectorAll('.point');
            points.forEach((point, i) => {
                point.innerHTML = '';
            });
        }

        function changeColor(pointNumber, color) {
            const point = document.getElementById(`point${pointNumber}`);
            if (point) {
                point.style.width = "20px";
                point.style.height = "20px";
                point.style.backgroundColor = color;
            }
        }

        function changeText(pointNumber, ladleno) {
            const point = document.getElementById(`point${pointNumber}`);
            if (point) {
                point.style.width = "20px";
                point.style.height = "20px";
                point.innerHTML = ladleno;
            }
        }

        // Function to fetch data and update colors and text
        async function fetchDataAndUpdate() {
        try {
            const response = await fetch("/ladles/latest/<%=data?.LadleNo%>");
            const result = await response.json();

            if (result.success) {
                resetColors();
                resetText();
                // console.log(result.data);

                changeColor(result.data.Location, randomColors[16]);
                changeText(result.data.Location, result.data.LadleNo);
            }
        } catch (error) {
            console.log(error);
        }
    }
    setInterval(fetchDataAndUpdate, 100);
        
    </script>
</body>

</html>